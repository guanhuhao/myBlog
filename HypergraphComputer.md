## Abstract
面对互联网、社交网络、生物网络之间存在的数据稀缺性以及复杂关联的挑战。大多数相关研究使用图结构来描述这些相关性，但图结构无法建模系统中复数个对象之间存在的高阶相关性，对于事物之间存在的错综复杂的关系捕捉能力相对薄弱。在图结构的基础上，超图放松图对于关系（relationship）参与对象数目的约束，使用超边建模多实体之间可能存在的联系。基于超图的计算，还有效利用数据和高阶关系相关性实现协同计算，为问题提供了更高的建模灵活度。当前针对超图计算可以划分为以下三类，以及对应解决的问题可以总结为：
> 1. 超图结构建模：如何使用超图构建对象之间以及对象内部复杂高阶关系？
> 2. 超图语义计算：如何基于超图结构表示并提取对象间高阶关系语义信息？
> 3. 高效超图计算：如何高效对超图相关性进行表示以及计算加速？

同时超图在一些特定任务中展现了优秀的表现，如本文聚焦的3D物体识别采用超图计算可以在实现相同性能的同时减少80%数据需求，或使用相同数据量提升52%性能。作者还就超图在生命科学、计算机视觉等领域中发挥的作用进行了综述概括，并介绍了当前一个开源超图学习库（DHG）  

## Intro
### 研究现状
在许多特定领域，如医疗和互联网生物网络，由于数据采集的限制、隐私保护的要求以及数据内部结构的复杂性，导致有效数据的稀缺性和复杂关系发现的困难。为了进一步理解数据内在特征以及复杂关联，超图作为一种新的范式被引入解决相关问题。
由真实世界中人脑记忆机制/物种间高阶相互作用/生物化学等领域相关研究启发，通过将这些高阶相互作用划分为主体内高阶关系（Intra-subject high-order correlations）以及主体间高阶关系（Inter-subject high order correlations）
[](https://guanhuhao.github.io/picx-images-hosting/PaperReading/HypergraphComputing/1.7ljxnj4u9j.jpg)
  
主体内高阶关系：以组织切片影像为例，每个图像块均可视为主体（subject），每个图像块同时包含细胞内环境以及肿瘤表示物的信息，这些属性可以作为该主体的表示，同时他们也可能存在复杂高阶关系
主体间高阶关系：以社交网络为例，每个用户被视为主体实体，用户间的互动（如观点表达/情绪渲染/兴趣交流）均可以视为不同主体间的高阶关系

### 超图的必要性
传统研究范式 vs 超图研究范式
传统研究希望从数据 $$Data X$$ 中学习到任务目标的映射函数 $$f(x)$$，该研究范式高度依赖大量充足且高质量的训练数据，无法解决很多领域面临的的数据稀缺性（data scarcity）以及复杂关系稀疏性（complex correlation sparsity）。
超图研究范式则通过基于知识以及规则的方式先对数据进行结构化建模（Strucure modeling）高阶关系 $$R$$，引入高阶相关性的方式实现对原始数据的高效利用，通过协同计算映射函数 $$f(X,R)$$提供更便利的建模灵活性。同时也由于基于知识以及规则，在一定程度上也提供了更好的可解释性
[](https://guanhuhao.github.io/picx-images-hosting/PaperReading/HypergraphComputing/2.2yyan4l3wx.jpg)

### 图 vs 超图
尽管近些年有大量相关研究工作使用图结构来建模上述关系，但是由于传统图结构仅能显式的捕捉实体之间的二阶关系，在面临涉及到复数个实体的复杂高阶关系建模时存在限制。
![](https://guanhuhao.github.io/picx-images-hosting/PaperReading/HypergraphComputing/3.5xakqmtdec.jpg)
以上图为例，图使用二元组（u，v）节点u，v之间存在某种联系，在面对更多节点共同的高阶作用时存在局限，而超图使用集合（set）的方式来进行存储以及管理涉及复数个对象的高阶关系。同时使用集合的方式还可以很方便的表示一组具有相似属性/关联的顶点，而这在图中是困难的。
在面对多模态数据时超图也具有更好的可拓展性，可以将多模态/多类型数据嵌入到超图中。
由于表示能力的差异，因此尽管对于部分问题可以将超图转化为图进行处理，但是仍有很多任务依赖于超图结构进行计算（如定点权重依赖于超边的标签传播算法）

## 超图计算
### 总览
本文主要讨论如何引入超图计算的概念用于解决上述提及的建模高维、复杂高阶关系的问题。作者将超图计算范式拆分为三个关键部分：超图结构建模、超图语义计算以及高效超图计算。其架构如下图
[](https://guanhuhao.github.io/picx-images-hosting/PaperReading/HypergraphComputing/4.b8ucrs2lb.jpg)
超图结构建模：该部分任务聚焦于“如何使用超图构建对象之间以及对象内部复杂高阶关系”，面临的挑战不仅包括信息关联的复杂性，也同时由于时间推移导致的结构演化，如何捕获这系列动态复杂性，对信息关联的演化机制进行研究同样具有很大的研究意义，同时数据还面临着观测值不完整，欠定信息以及数据噪声等数据完备性的挑战，限制了对于超图构建的全面性。

超图语义计算: 若已用超图构建起对象间复杂高阶关系的结构表示，该部分任务主要解决"如何基于超图结构表示并提取对象间高阶关系语义信息"，目前该任务主要使用超图神经网络，通过设计超图卷积算子来实现超图结构语义信息表示学习。

高效超图计算: 实际应用中的超图分析任务常常面临着大规模数据的挑战，而相较于图计算，超图计算任务往往面临更高计算复杂度，因此该部分聚焦于面临大规模数据时如何高效对相关性进行建模以及计算加速。
超图结构建模
结构建模是进行超图计算的初始步骤，而构建超图主要分为两种：
>+ 知识和规则驱动的建模: 通过网络和基于属性的方式对知识和规则的高阶相关性进行建模。根据专业领域不同，需要引入具体领域的专家知识构建多模态数据（例如时间、空间、气候、文本描述）之间的联系。可以更细分为基于属性的（Attribute-based）以及基于网络的（Network-based），基于属性的建模关注对象的特定属性，将具有相似或相同属性的对象通过超边进行连接。而基于网络的将对象具有的初始网络结构的节点构建超边联系。
>+ 数据驱动建模：基于距离和基于表示的方式对数据的高阶相关性进行建模。本文以视觉对象分类任务为例，图像可以划分为若干图像块，可以通过计算图像块之间的的距离构建超边关系。而在医疗计算机辅助诊断任务中，构建组织病理学图像块之间的链接，同样可以使用超边表示相互之间的联系。同样可以进一步划分为基于距离的（Distance-based）以及基于表示的（Representation-based）。基于距离的构造将目标节点在特征空间中计算距离来构建超边关系（例如KNN， $$\epsilon-ball$$等聚类算法），而基于表示的构造方法将数据在特征空间中进行分析计算相关性表征构成超边。

除了上述提及的建模方法，还有引入不同类型的节点，针对不同场景与任务定制的策略生成不同的超边，以构建异构超图（Heterogeneous Hypergraph）。而随着多模态数据的发展，来源于异构数据源的信息同样具有错综复杂的模式以及挖掘有价值信息的潜力，但处理多模态数据面临着如何对齐不同模态的数据同时考虑他们的语义信息以及属性，也需要处理不同中心性分布的超图特征（例如使用归一化技术以及加权超图融合方法）。  
针对构建超图时由于数据采集的不确定以及捕获高阶关系的困难性导致的数据欠定（Underdetermined Data）问题。因此需要对超图结构进行优化，增强超图建模的适应性以及相关性，贝叶斯超图建模（BHGM）被引入以根据不同任务、模型和数据集的需求自动生成合适的超图结构。  
由于超图可以表示为集合，通过赋予集合数学结构以构成超图空间，因此可以通过组合以及微调的方式构成新的超图结构以探索超图结构的演化。为解决该问题本文提出可以通过合适的度量来衡量超图之间的相似性，以此通过将结构演化的稳定性转化为度量空间的完备性以及序列的收敛性。作者表示可以通过构造超图结构的线性表示框架，对超图进行线性组合以研究其线性空间的完备性，通过优化组合系数可以获得最优超图结构，为研究超图结构烟花提供数学框架。
尽管超图在对于建模/捕捉高阶关系中具有优越性，但对于需要大规模实时计算等场景中存在局限，因为超边封装了复杂高阶关系导致计算开销的急剧增长，对快速实时决策带来了巨大的挑战，因此高效地进行超图计算与推断可以极大的拓展超图实际应用

### 超图语义计算
若超图结构已建立，需要对节点进行语义信息计算以得到准确的节点表示。超图神经网络(Hypergraph Neural Network)将超图建模能力与神经网络的表征能力相结合，通过使用超图卷积操作来学习结构的语义表示，超图卷积操作大致可以化分为：基于谱域的方法（Spectral-based methods）以及基于空域的方法（Spatial-based methods）
#### 基于谱域的方法：
基于谱域的方法分为大致可以分为两步：
> 1. 通过傅里叶变换将信息从空域转化为谱域，并在谱域上使用卷积算子进行卷积。
> 2. 将信号通过傅里叶逆变换转化为空域中实现节点信息表示。

其中HGNN（2019-AAAI）为基于谱域方法的代表，其将图拉普拉斯变换以及图傅里叶变换推广到超图拉普拉斯变换以及超图傅里叶变换并推导出谱域的超图卷积。而Hyper-Atten（2021-PR）使用基于谱域的卷积操作通过添加注意力模块自适应学习节点的重要性。HyperGCN（2019-NIPS）则通过特定规则将超图转化为图，在图上进行卷积操作，该方法好处在于充分利用相对成熟的图嵌入技术，但由于将简化高阶关系简化为承兑关系因此可能会导致部分结构信息丢失。
#### 基于空域的方法：
基于空域的方法与基于谱域最大的不同在于通过聚合邻居节点（Neighboring Aggregation）的表示来获得中心节点的新表示.HGNN+(2022-TPAMI)引入超图路径的概念实现了高阶信息在超图上的传播。HGNN+将卷积过程化分为两阶段，第一阶段由中心节点将信息传递到与中心节点相关的超边，第二阶段将信息由超边传递给对应节点。由于卷积以及聚合操作可以自由定义，因此HGNN+具有灵活性以及拓展性，并可以拓展进有向超图。
与图神经网络类似的，目前关于超图神经网络的研究仍然需要面对“随着卷积层数的增加，网络出现不可避免地退化以及不稳定”的挑战，而作者认为从数学地角度对稳定计算方法地探索是重要的，而超图动态系统（Hypergraph dynamic system 2024 ICLR）是一种可能地解决方案。

### 异构超图表示
另一方面，基于同构超图设计地方法通常无法直接用于异构超图地表示中，亟需解决地问题在于“如何有效编码异构节点以及异构关系进隐空间？”。HGTN（2023-TKDD）通过使用注意力机制来调整异构超图中地信息来实现异构语义信息编码

### 高效超图计算
随着数据规模的迅速增长，在一些特定领域的应用中超图规模可以达到百万甚至数十亿个节点（例如互联网/社交网络），因此需要高效超图构建/计算方法以在可接受的时间/空间内处理大规模数据。对于高效超图建模可以从以下四个方面入手：
> 1. 超图分解（Hypergraph Factorization）：出发点在于若使用邻接矩阵的方式表示超图则需要 $$O(NM)$$的空间用于存储节点-超边连接关系，而该矩阵通常是稀疏的。因此将节点-超边连接关系编码进低维向量空间中（使用“属于”子关联矩阵，“包含”子关联矩阵），使得模型可以拟合初始大规模超图结构。
> 2. 超图采样（Hypergraph Sampling）：传统直推式学习要求获取全图信息，进行全批次学习（full-batch training），而由于硬件限制（GPU显存占用）使得对于处理大规模超图数据时，传统学习算法存在局限。因此通过将超图根据层数采样多条邻居的方式构建子超图，并作为小批次投入卷积层。
> 3. 分层超图建模（Hierarchical Hypergraph Modeling）：由于超图数据可能携带层次标签，因此这类超图自然的可以划分为多个子集,通过使用KNN等方式将子集构建为子超图，对于子超图进行超图学习可以再隐空间中获得高阶关系的局部表示，再通过多个聚合算子融合不同层次标签，通过融合局部高阶表示以获取全局的表示
> 4. 分布式超图建模（Distributed Hypergraph Modeling）：大规模数据上训练超图神经网络常常受单个设备的计算能力限制，因此使用并行策略在集群上采用分布式训练的方式可以缓解该限制。首先将数据划分为托干分区，再使用超图神经网络进行优化，该过程中节点需要进行通信以及同步，并通过聚合梯度来更新模型参数。
除上述提及方法之外超图结构压缩（Hypergraph Structure Compression）以及知识蒸馏（Knowledge Distillation）来提高超图计算效率。超图结构压缩旨在通过超图同构我们可以分析结构等价性来减小求解空间，而知识蒸馏可以将复杂高阶关系注入到推理有效的浅层网络中来加速计算。

## 超图应用
在生命科学以及计算机视觉领域中，由于多层次、多维度、多模态、异构数据的激增，超图计算凭借其强大的高阶关系建模能力被广泛适用于多种任务中。
### 超图与医学智能
#### 蛋白质/药物/疾病
由于超图可以模拟蛋白质之间的高阶相互作用，例如将蛋白质视为节点，将蛋白质-蛋白质相互作用（Protein-Protein Interaction简称为PPI）视为超边。PPIs 可以用来预测蛋白质结构以及属性，并可以用来设计具有特定功能的新蛋白质。药物之间的协同/拮抗作用同样也可以构建为超边，通过捕捉复杂的药物相互作用，降低高昂的实验成本，解决药物发现中组合爆炸的问题。
#### 细胞/组织
超图可以学习组织内部复杂的结构关联与多个细胞之间的相互作用，揭示复杂生物学功能/增强疾病诊断准确性。例如千亿像素级别的病理图像包含了高分辨率的细胞形态学以及肿瘤微环境的数字信息。将单个细胞或区域视为节点，根据空间拓扑相关性或节点间特征距离定义超边，通过超图计算可以有效学习细胞心态与细胞间相互作用之间的复杂相关性，对癌症分级/分期以及预测患者生存期提供重要依据。
#### 器官
超图可以用于模拟器官内不同区域或组织之间的复杂关系，从而对复杂功能连接相互作用进行建模。例如大脑可以理解为无数神经元以及不同功能的脑区组成，超图可以准确捕捉这些神经元和脑区之间的复杂关系，并成功识别出激活的脑区以及对应的功能脑图，还能通过比较不同个体之间的脑网络结构来区别正常/异常脑连接。
#### 生物系统
临床诊断中使用人类表型术语（HPO）来描述疾病，而任意一种疾病可以视为一系列表型的集合，超图可以将HPO视为节点，而疾病视为超边建立起表型与疾病之间的关联，通过建立疾病之间共有的表型特征，推断共同的致病机理或基因突变，还能用于生物标志物的发现。超图因此已被证明对于疾病表型相关性的研究是有价值的，不仅揭示了疾病之间的共同特征与差异，还有助于识别潜在的疾病亚型以及疾病相关性。与药物共同建模还能学习到药物与疾病之间的关联信息，以揭示药物相互作用与特定疾病之间的相关性，从而v昂住预测潜在的药物副作用。
### 超图与个体
超图还可以用于研究个体级别的数据，例如分析不同患者的跨模态，多视图临床数据（例如生活习惯，遗传形状，换金印紫、焦虑与医疗保健），使得识别整个人群的健康趋势与患病率等，促进更精准的公共卫生决策与资源分哦欸，通过整合多来源的多模态数据。也可以整合来自群体以及个体俩个层面的数，获得内部超图，提供更全面和丰富的知识
### 超图与计算机视觉
超图已被证明是一种高度灵活的计算框架并用于计算机视觉任务中的各项任务中，如：姿态识别，深度估计，图像配准，3D识别，检索，场景理解以及目标检测中。
#### 姿态估计
超图提供了一种更好的框架用于编码身体姿态/动作序列/动作序列的时空相关性，由于能更好捕捉高阶关系，使得超图在预测精度/计算效率方面都优于传统方法。超图方法相较传统方法的优越性体现在传统方法可能仅利用了低级特征以及局部数据，而超图对动作以及动作序列的理解更全面。该特性使得超图在诸如安全监控/行为分析/人机交互等领域不可或缺。
#### 深度估计
相较于传统方法会丢失全局上下文信息，超图可以在更广泛的空间中捕捉像素之间的复杂相关性以及上下文信息。因此使用超图的深度估计方法通常可以提高深度估计的质量。例如在机动车自动驾驶场景中，传统深度估计方法不能很好的处理复杂交通环境特别是多个参与者的情况。而超图可以整合不同传感器以及视角的信息进行更全面/准确的深度估计从而保证了更高的安全性，同样的在增强现实以及虚拟现实中更准确的深度信息对于用户提供更逼真的沉浸式体验至关重要。
#### 配准
超图配准方法可以有效处理复杂空间变换，传统方法只能处理像素-像素或区域-区域的相关性，而超图可以捕捉并融合多层次的相关性以提高配准的准确性。在点云数据配准的情况下，超图算法可以分析点云之间的高阶几何和拓扑相关性，有效提升自动驾驶/机器导航/3D建模的性能。并且超图擅长处理存在大量噪声或遮挡的图像/点云数据，而传统配准方法在这种复杂场景下通常需要额外的数据预处理步骤，而超图可以实现端到端的模型训练，提高配准的准确度和效率.
#### 3D识别与检索
对于三维物体识别和检索任务，超图可以分析三维模型内部高阶关系以及拓扑相关性。例如工业制造业中，超图可以用于精确匹配和识别机器零件/组件提高生产效率和质量。视频游戏开发/电子娱乐中，超图可以用于识别/渲染复杂3D环境。在文化遗产保护以及考古中针对三维数据的高效分析。
#### 场景理解
传统方法通常仅关注局部信息以及2D图像数据忽略了复杂场景更高阶的相关性以及相互依赖关系，二超图可以提供更复杂的对于整体场景的理解。例如在智能交通与城市规划中超图可以用来分析多种交通参与者（如机动车/行人/自行车）与周围环境（如交通标识道路障碍/布局）的高阶关系。对于可以高效预测解释交通流。同时超图在自然灾害或紧事件发生时可以快速分析影响因素（如天气情况/地形/植被分布）并模拟可能的传播路径以及影响区域从而帮助更好的决策。
#### 目标检测
目标检测场景通常涉及复杂背景，多实体分类以及遮挡的目标检测场景中，而超图可以很好的分析目标与周围环境的复杂依赖。更具体地超图可以通过多方面地考察目标与周围上下文之间地关系来提高检测的准确度，例如相对位姿，运动模式，颜色纹理等。在轨道交通环境中，由于可以同时分析以及捕捉多个动态/静态目标，因此可以更好的预测动作行为以及潜在的风险。
### 其他
本文中还提及超图可以被用于很多其他领域中，例如金融/化学与材料科学/教育学中，但文中没详细介绍这部分内容，但列举了相关文献支持，与上述提及的医学智能以及计算机视觉以表格的方式进行展示，如下：
[](https://guanhuhao.github.io/picx-images-hosting/PaperReading/HypergraphComputing/5.13lpui8obm.jpg)
[](https://guanhuhao.github.io/picx-images-hosting/PaperReading/HypergraphComputing/6.7i0bq3qkv9.jpg)
## 实验
本文为了探究超图计算的有效性，使用3D目标识别作为实验任务，使用ModelNet40作为3D目标数据集。使用HGNN作为超图计算方法，而是用GVCNN作为图卷积神经网络的对比方法，分别使用从6%到100%的数据用于训练比较超图方法与传统图卷积方法在不同规模数据训练下的效果。
在全数据情况下，HGNN较GVCNN降低了3%的绝对误差率（相对误差率为GVCNN的48%），并且随着训练数据的减少HGNN性能下降不显著，在仅用总数据量20%的情况下达到了GVCNN在全数据下的相近性能
[](https://guanhuhao.github.io/picx-images-hosting/PaperReading/HypergraphComputing/7.2rv2royyi0.jpg)
### 超图计算工具
DeepHypergraph（DHG）是第一个基于PyTorch的开源深度学习库用于超图计算，架构图如下：
[](https://guanhuhao.github.io/picx-images-hosting/PaperReading/HypergraphComputing/8.7sn5j95t0r.jpg)
在兼容了成对关系的图结构消息传播的情况下，针对超图结构还实现了超越成对关系的消息传播。同时还实现了将图与超图相互转化的函数，通过将图转化为超图可以挖掘潜在的高阶联系并提高模型性能。
基于PyTorch，超图计算库DHG还继承了关于PyTorch的相关模型的相关接口，例如功能强大的可视化工具，以及提供了拉普拉斯矩阵和消息传递函数帮助建立基于谱域或基于空域的模型建立。也集成了随机图/超图生成器，前沿卷积层，公开数据集以及多种有效的指标计算。也集成了Optuna库用于自动化微调模型结构，自动搜索最有超参配置。
## 结论
本文主要介绍了超图计算如何使用超图来建模系统高阶相关性，并如何对数据以及高阶相关性进行协同计算。阐述了超图对于表示高阶关系的必要性并提供了详细的证明。并介绍了超图结构建模方式，超图语义计算以及高效超图计算的相关概念，将基于超图的方法与GNN相比较，表现了超图神经网络不仅可以有效处理成对的简单关系，还勇士具有捕捉/建模高阶关系的能力，总结了超图在生命科学/计算机视觉等相关领域的具体应用。以3D目标识别为例，超图计算可以减少80%的数据需求以达到与GNN相当的效果，或在相同数据需求下降低52%的误差，并介绍了超图计算的开源框架DHG。
作者表示超图计算仍然有很大的探索空间，特别是在大模型崛起阶段，可能存在将超图与大模型相结合的技术路线，将大模型在文本数据的强大表示能力与超图对复杂/高阶关系的捕捉能力相结合，增强LLM对于复杂结构信息的理解，弥合文本理解与高阶相关性建模之间的gap，或者是利用LLM发现数据中复杂模式和关联，为超图相关研究提供更丰富的信息以及机会，丰富超图中的关系信息，推动不同任务中可实现的内容边界。为此未来对于超图的挑战将集中于图和优化超图计算中计算效率和存储的压力。